# üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ "–°–¥–µ–ª–∫–∞"

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç "–°–¥–µ–ª–∫–∞" –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:

- **SQLite** - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤
- **PostgreSQL** - –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- **Mock** - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: SQLite (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)

```bash
# Python –≤–µ—Ä—Å–∏—è —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite
python main.py

# Flutter –≤–µ—Ä—Å–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç SQLite –µ—Å–ª–∏ PostgreSQL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
cd flutter_sdelka/sdelka_v4
flutter run
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: PostgreSQL —á–µ—Ä–µ–∑ Docker

```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL –≤ Docker
python docker_postgresql.py

# –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQLite –≤ PostgreSQL
python migrate_sqlite_to_postgresql.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: PostgreSQL (—Ä—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL 15+
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
   ```sql
   CREATE DATABASE sdelka_v4;
   CREATE USER sdelka_user WITH PASSWORD 'sdelka_password';
   GRANT ALL PRIVILEGES ON DATABASE sdelka_v4 TO sdelka_user;
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:
   ```bash
   python migrate_sqlite_to_postgresql.py
   ```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### SQLite
- **–§–∞–π–ª**: `data/base_sdelka_rmz.db`
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ü—Ä–æ—Å—Ç–æ—Ç–∞, –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### PostgreSQL
- **Host**: localhost:5432
- **Database**: sdelka_v4
- **User**: sdelka_user
- **Password**: sdelka_password
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**: –¢—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

## üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- `employees` - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
- `products` - –∏–∑–¥–µ–ª–∏—è
- `work_types` - –≤–∏–¥—ã —Ä–∞–±–æ—Ç
- `contracts` - –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
- `work_orders` - –Ω–∞—Ä—è–¥—ã
- `work_order_items` - —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ä—è–¥–æ–≤
- `work_order_products` - –∏–∑–¥–µ–ª–∏—è –≤ –Ω–∞—Ä—è–¥–∞—Ö
- `work_order_workers` - —Ä–∞–±–æ—á–∏–µ –≤ –Ω–∞—Ä—è–¥–∞—Ö
- `contract_history` - –∏—Å—Ç–æ—Ä–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### SQLite ‚Üí PostgreSQL

```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
python docker_postgresql.py

# 2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
python migrate_sqlite_to_postgresql.py

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
# –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ migration.log
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è UUID –¥–ª—è –∑–∞–ø–∏—Å–µ–π –±–µ–∑ ID
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üê≥ Docker –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL
python docker_postgresql.py

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
python docker_postgresql.py stop

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs postgres-sdelka

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ
docker exec -it postgres-sdelka psql -U sdelka_user -d sdelka_v4
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL:
```python
import psycopg2

try:
    conn = psycopg2.connect(
        host="localhost",
        port=5432,
        database="sdelka_v4",
        user="sdelka_user",
        password="sdelka_password"
    )
    print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ")
    conn.close()
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ SQLite:
```python
import sqlite3

try:
    conn = sqlite3.connect("data/base_sdelka_rmz.db")
    cursor = conn.cursor()
    cursor.execute("SELECT COUNT(*) FROM employees")
    count = cursor.fetchone()[0]
    print(f"‚úÖ SQLite: {count} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤")
    conn.close()
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### SQLite:
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- ‚úÖ –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
- ‚ùå –ù–µ—Ç —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### PostgreSQL:
- ‚úÖ –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –°–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü:

1. **SQLite** - –æ–±–Ω–æ–≤–∏—Ç–µ `db/schema.py`
2. **PostgreSQL** - –æ–±–Ω–æ–≤–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
3. **Flutter** - –æ–±–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# –¢–µ—Å—Ç—ã —Å SQLite
python run_tests.py

# –¢–µ—Å—Ç—ã —Å PostgreSQL (—Ç—Ä–µ–±—É–µ—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
POSTGRES_URL=postgresql://sdelka_user:sdelka_password@localhost:5432/sdelka_v4 python run_tests.py
```

## üìù –õ–æ–≥–∏

- **–ú–∏–≥—Ä–∞—Ü–∏—è**: `migration.log`
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: `logs/app.log`
- **Docker**: `docker logs postgres-sdelka`

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### PostgreSQL –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 5432 —Å–≤–æ–±–æ–¥–µ–Ω
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs postgres-sdelka`

### –û—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SQLite —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL

### Flutter –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—â–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- [SQLite Documentation](https://www.sqlite.org/docs.html)
- [Docker PostgreSQL](https://hub.docker.com/_/postgres)
- [Flutter Database](https://docs.flutter.dev/development/data-and-backend/state-mgmt/options)
